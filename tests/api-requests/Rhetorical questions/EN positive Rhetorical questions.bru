meta {
  name: EN positive Rhetorical questions
  type: http
  seq: 6
}

post {
  url: {{rhetoricalQuestionsUrl}}/analyse
  body: json
  auth: inherit
}

body:json {
  {
    "text": "Seriously? Does a bear live in the woods? Because frankly, what's the big deal about this whole situation? You expect me to believe that? I mean, who needs enemies with friends like these? It's like, isn't it obvious by now why I'm asking, 'Why on earth would you do that?' What more could you ask for than a clear explanation, and yet, here we are again. So, is that even a question that needs answering? Probably not, but are we there yet with all this confusion?"
  }
}

tests {
  test("Status should be 200", function () {
    expect(res.getStatus()).to.equal(200);
  });
  
  const expectedPhrases = [
    "Seriously?",
    "Does a bear live in the woods?",
    "Because frankly, what's the big deal about this whole situation?",
    "You expect me to believe that?",
    "I mean, who needs enemies with friends like these?",
    "It's like, isn't it obvious by now why I'm asking, 'Why on earth would you do that?'",
    "What more could you ask for than a clear explanation, and yet, here we are again.",
    "So, is that even a question that needs answering?",
    "Probably not, but are we there yet with all this confusion?"
  ];
  
  expectedPhrases.forEach(phrase => {
    test(`Sentence '${phrase}' should be detected`, function () {
      const found = res.body.some(item => item.detected_phrase === phrase);
      expect(found).to.be.true;
    });
  });
  
  test("No unexpected phrases should be returned", function () {
    const actualPhrases = res.body.map(item => item.detected_phrase);
    const unexpectedPhrases = actualPhrases.filter(p => !expectedPhrases.includes(p));
    console.log("Unexpected phrases: ", unexpectedPhrases);
    expect(unexpectedPhrases).to.be.empty;
  });
  
  console.log(res.body);
}
