meta {
  name: EN Absolute Terms
  type: http
  seq: 5
}

post {
  url: {{ruleBasedUrl}}/analyse
  body: json
  auth: inherit
}

body:json {
  {
    "text": "The suspect is obviously guilty based on the evidence. The witness is clearly mistaken about the timing. The defendant undoubtedly knew about the illegal activity. The evidence proves beyond question that the suspect was present.",
    "language": "en"
  }
}

tests {
  test("Status should be 200", function () {
    expect(res.getStatus()).to.equal(200);
  });
  
  const expectedPhrases = [
    "obviously",
    "clearly",
    "undoubtedly",
    "beyond question"
  ];
  
  expectedPhrases.forEach(phrase => {
    test(`Phrase '${phrase}' should be detected`, function () {
      const found = res.body.some(item => item.detected_phrase === phrase);
      expect(found).to.be.true;
    });
  });
  
  test("No unexpected phrases should be returned", function () {
    const actualPhrases = res.body.map(item => item.detected_phrase);
    const unexpectedPhrases = actualPhrases.filter(p => !expectedPhrases.includes(p));
    console.log("Unexpected phrases: ", unexpectedPhrases);
    expect(unexpectedPhrases).to.be.empty;
  });
  
  console.log(res.body);
}
